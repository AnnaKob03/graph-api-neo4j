# REST API сервис на FastAPI и Neo4j

Данный проект реализует REST API для работы с графовой базой данных **Neo4j** с использованием фреймворка **FastAPI**. Сервис позволяет управлять узлами пользователей и групп, а также их связями.

## Возможности

- REST API для управления пользователями и группами в Neo4j.
- CRUD-операции:
  - **GET**: Получение всех узлов или конкретного узла с его связями.
  - **POST**: Добавление новых узлов и связей.
  - **DELETE**: Удаление узлов и их связей.
- Защита точек доступа **POST** и **DELETE** с помощью токена авторизации.
- Автоматические тесты для всех точек доступа.

---

## Установка и настройка

### Предварительные требования
- Python версии 3.9 или выше.
- Установленная и запущенная база данных Neo4j.
- Настройка переменных окружения в файле `.env`:
  ```plaintext
  DATABASE_URL=bolt://localhost:7687
  NEO4J_USER=ваш_логин_neo4j
  NEO4J_PASSWORD=ваш_пароль_neo4j
  API_TOKEN=ваш_секретный_токен

### Установка
1. Клонируйте репозиторий:
 ```bash
  git clone https://github.com/AnnaKob03/graph-api-neo4j
  cd graph-api-neo4j
   ```
2. Установите зависимости:
 ```bash
   pip install -r requirements.txt
   ```
3. Запустите базу данных Neo4j.
4. Запустите приложение FastAPI:
 ```bash
   uvicorn api.main:app --reload
   ```
## Точки доступа
### Точки доступа пользователей
| Метод  | Endpoint                          | Описание                                 |
|--------|-----------------------------------|-----------------------------------------|
| GET    | `/users/`                        | Получить всех пользователей.           |
| GET    | `/users/{user_id}/relationships/`| Получить пользователя и его связи.     |
| POST   | `/users/`                        | Создать нового пользователя.           |
| DELETE | `/users/{user_id}`               | Удалить пользователя и его связи.      |


### Точки доступа групп
| Метод  | Endpoint                              | Описание                             |
|--------|---------------------------------------|-------------------------------------|
| GET    | `/groups/`                           | Получить все группы.                |
| GET    | `/groups/{group_id}/relationships/`  | Получить группу и её связи.         |
| POST   | `/groups/`                           | Создать новую группу.               |
| DELETE | `/groups/{group_id}`                 | Удалить группу и её связи.          |

## Запуск тестов
Для запуска тестов выполните команду:
```bash
   pytest tests/test_main.py
   ```
Все тестовые случаи находятся в папке tests/.

## Развёртывание на VDS (без контейнеров)
1. Установите зависимости на сервере:
```bash
   sudo apt update
   sudo apt install python3 python3-venv python3-pip
   ```
2. Клонируйте проект на сервер:
 ```bash
  git clone https://github.com/AnnaKob03/graph-api-neo4j
  cd graph-api-neo4j
   ```
3. Создайте виртуальное окружение и установите зависимости:
 ```bash
  python3 -m venv .venv
  source .venv/bin/activate
  pip install -r requirements.txt
   ```
4. Настройте файл .env с вашими параметрами.
5. Запустите приложение:
 ```bash
  uvicorn api.main:app --host 0.0.0.0 --port 8000
   ```
6. (Опционально) Настройте сервис systemd для автоматического запуска приложения.

## Важные примечания
- Используйте API_TOKEN для авторизации запросов к точкам POST и DELETE.
- Для работы с базой данных используется драйвер Neo4j. Убедитесь, что база доступна.